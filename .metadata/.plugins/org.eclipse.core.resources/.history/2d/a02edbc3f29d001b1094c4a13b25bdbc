<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
</head>
<body>

<%@ page import="BasicServlet.*" %>
<%@ page import="java.sql.*" %>
<%
HttpSession s= request.getSession(true);
Employee emp=(Employee) s.getAttribute("emp");

WorkProgress wpr=new WorkProgress(emp.persno,(String)request.getParameter("wpd"),(String)request.getParameter("projectId"),(String)request.getParameter("projectName"),(String)request.getParameter("projectDesc"),(String)request.getParameter("status"),(String)request.getParameter("PDC"));
DNET DNet=new DNET();
Connection dbConnection=DNet.getConnection();
PreparedStatement pStatement;
try {
	pStatement=dbConnection.prepareStatement("UPDATE "+DNet.MPR_WorkProgress+" SET STATUS=?,PDC=TO_DATE(?,'YYYY/MM/DD') WHERE F_CPERSNO=? AND PROJECT_ID=? AND TO_CHAR(WP_DATE,'DD/MM/YYYY') LIKE ?");
	pStatement.setString(1,wpr.status);
	pStatement.setString(2,wpr.PDC);
	pStatement.setString(3,wpr.persno);
	pStatement.setString(4,wpr.projectId);
	pStatement.setString(5,wpr.wpDate);
	pStatement.executeUpdate();
	pStatement=dbConnection.prepareStatement("UPDATE "+DNet.Project+" SET PROJECT_NAME=?,DESCRIPTION=? WHERE PROJECT_ID=?");
	pStatement.setString(1,wpr.projectName);
	pStatement.setString(2,wpr.projectDescription);
	pStatement.setString(3,wpr.projectId);
	pStatement.executeUpdate();
} catch (SQLException e) {
	e.printStackTrace();
}
s.setAttribute("upd", 1);
RequestDispatcher rd=request.getRequestDispatcher("index3.jsp");
rd.forward(request, response);
%>
</body>
</html>